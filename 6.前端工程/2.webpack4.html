<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2.webpack4 | Yankyao</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/index/favicon.ico">
    <script>(function() {
            const theme = localStorage.getItem('theme');
            if(theme) {
              document.documentElement.classList.add(theme);
            }
        })()</script>
    <meta name="description" content="个人主页">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="preload" href="/index/assets/css/0.styles.8e715b3c.css" as="style"><link rel="preload" href="/index/assets/js/app.616a5d86.js" as="script"><link rel="preload" href="/index/assets/js/3.1c123f76.js" as="script"><link rel="preload" href="/index/assets/js/48.4ffdce64.js" as="script"><link rel="prefetch" href="/index/assets/js/10.f946ddfb.js"><link rel="prefetch" href="/index/assets/js/11.7ca028bd.js"><link rel="prefetch" href="/index/assets/js/12.efc30772.js"><link rel="prefetch" href="/index/assets/js/13.0fb4045c.js"><link rel="prefetch" href="/index/assets/js/14.e1a8fc61.js"><link rel="prefetch" href="/index/assets/js/15.e2c47e9b.js"><link rel="prefetch" href="/index/assets/js/16.84ddb9b3.js"><link rel="prefetch" href="/index/assets/js/17.28a272b1.js"><link rel="prefetch" href="/index/assets/js/18.159d6c82.js"><link rel="prefetch" href="/index/assets/js/19.7cb29359.js"><link rel="prefetch" href="/index/assets/js/2.f640426f.js"><link rel="prefetch" href="/index/assets/js/20.958b3486.js"><link rel="prefetch" href="/index/assets/js/21.c0008dbc.js"><link rel="prefetch" href="/index/assets/js/22.3a84ca04.js"><link rel="prefetch" href="/index/assets/js/23.5921138e.js"><link rel="prefetch" href="/index/assets/js/24.c33e2445.js"><link rel="prefetch" href="/index/assets/js/25.b7280818.js"><link rel="prefetch" href="/index/assets/js/26.29409481.js"><link rel="prefetch" href="/index/assets/js/27.2e608d78.js"><link rel="prefetch" href="/index/assets/js/28.a6e39256.js"><link rel="prefetch" href="/index/assets/js/29.a0eeb6c2.js"><link rel="prefetch" href="/index/assets/js/30.4b251976.js"><link rel="prefetch" href="/index/assets/js/31.bf2a7f5d.js"><link rel="prefetch" href="/index/assets/js/32.03da61f5.js"><link rel="prefetch" href="/index/assets/js/33.12b1b222.js"><link rel="prefetch" href="/index/assets/js/34.4863790e.js"><link rel="prefetch" href="/index/assets/js/35.d9cb002e.js"><link rel="prefetch" href="/index/assets/js/36.32cd5cc0.js"><link rel="prefetch" href="/index/assets/js/37.658aece8.js"><link rel="prefetch" href="/index/assets/js/38.e97b9ebe.js"><link rel="prefetch" href="/index/assets/js/39.ce9aabc9.js"><link rel="prefetch" href="/index/assets/js/4.b28fbb04.js"><link rel="prefetch" href="/index/assets/js/40.9fe8550e.js"><link rel="prefetch" href="/index/assets/js/41.c927e06e.js"><link rel="prefetch" href="/index/assets/js/42.cc52b19f.js"><link rel="prefetch" href="/index/assets/js/43.aafc913b.js"><link rel="prefetch" href="/index/assets/js/44.665f5dc1.js"><link rel="prefetch" href="/index/assets/js/45.996e6e7b.js"><link rel="prefetch" href="/index/assets/js/46.e9783fe5.js"><link rel="prefetch" href="/index/assets/js/47.0d61feab.js"><link rel="prefetch" href="/index/assets/js/49.5cbb9ccf.js"><link rel="prefetch" href="/index/assets/js/5.617e483c.js"><link rel="prefetch" href="/index/assets/js/50.bedbb097.js"><link rel="prefetch" href="/index/assets/js/51.f0dbfffc.js"><link rel="prefetch" href="/index/assets/js/52.73dd07c3.js"><link rel="prefetch" href="/index/assets/js/53.195b07fa.js"><link rel="prefetch" href="/index/assets/js/54.06b5b4c6.js"><link rel="prefetch" href="/index/assets/js/55.805c5424.js"><link rel="prefetch" href="/index/assets/js/56.78a67d01.js"><link rel="prefetch" href="/index/assets/js/57.a8dfe051.js"><link rel="prefetch" href="/index/assets/js/58.acac9c38.js"><link rel="prefetch" href="/index/assets/js/59.64640e48.js"><link rel="prefetch" href="/index/assets/js/6.63039d09.js"><link rel="prefetch" href="/index/assets/js/60.5c1e89a8.js"><link rel="prefetch" href="/index/assets/js/61.a4d694c4.js"><link rel="prefetch" href="/index/assets/js/62.7fec771d.js"><link rel="prefetch" href="/index/assets/js/63.b406a2e3.js"><link rel="prefetch" href="/index/assets/js/64.4e64e829.js"><link rel="prefetch" href="/index/assets/js/65.0f36adc2.js"><link rel="prefetch" href="/index/assets/js/66.3ddfe175.js"><link rel="prefetch" href="/index/assets/js/67.0ee31d44.js"><link rel="prefetch" href="/index/assets/js/68.df5f6a50.js"><link rel="prefetch" href="/index/assets/js/69.ef1a20a1.js"><link rel="prefetch" href="/index/assets/js/7.74c3c48d.js"><link rel="prefetch" href="/index/assets/js/70.5d2c241e.js"><link rel="prefetch" href="/index/assets/js/71.53a85aed.js"><link rel="prefetch" href="/index/assets/js/72.bf96963b.js"><link rel="prefetch" href="/index/assets/js/73.cb67b0ea.js"><link rel="prefetch" href="/index/assets/js/8.14e82a3d.js"><link rel="prefetch" href="/index/assets/js/9.007e4c2a.js">
    <link rel="stylesheet" href="/index/assets/css/0.styles.8e715b3c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/index/" class="home-link router-link-active"><!----> <span class="site-name">Yankyao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/index/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/index/about.html" class="nav-link">
  About
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/index/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/index/about.html" class="nav-link">
  About
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>1.入门</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2.html</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3.css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>4.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>5.前端框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>6.前端工程</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/index/6.前端工程/1.前端工程化.html" class="sidebar-link">1.前端工程化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/index/6.前端工程/1.前端工程化.html#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/1.前端工程化.html#版本管理" class="sidebar-link">版本管理</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/1.前端工程化.html#ci-cd" class="sidebar-link">CI/CD</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/1.前端工程化.html#架构设计" class="sidebar-link">架构设计</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/1.前端工程化.html#模块化" class="sidebar-link">模块化</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/1.前端工程化.html#前端编程兼容策略" class="sidebar-link">前端编程兼容策略</a></li></ul></li><li><a href="/index/6.前端工程/2.webpack4.html" class="active sidebar-link">2.webpack4</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#关键点" class="sidebar-link">关键点</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#webpack工作流程-生命周期" class="sidebar-link">webpack工作流程（生命周期）</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#loader、plugin原理" class="sidebar-link">loader、plugin原理</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#webpack4" class="sidebar-link">webpack4</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#配置webpack4" class="sidebar-link">配置webpack4</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#babel" class="sidebar-link">Babel</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#webpack-dev-server" class="sidebar-link">webpack-dev-server</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#热更新机制" class="sidebar-link">热更新机制</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#懒加载机制" class="sidebar-link">懒加载机制</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/2.webpack4.html#postcss" class="sidebar-link">postcss</a></li></ul></li><li><a href="/index/6.前端工程/3.混合APP.html" class="sidebar-link">3.混合APP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/index/6.前端工程/3.混合APP.html#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/3.混合APP.html#cordova、ionic" class="sidebar-link">Cordova、Ionic</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/3.混合APP.html#electron" class="sidebar-link">electron</a></li></ul></li><li><a href="/index/6.前端工程/4.团队协作.html" class="sidebar-link">4.团队协作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/index/6.前端工程/4.团队协作.html#分支管理" class="sidebar-link">分支管理</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/4.团队协作.html#代码风格" class="sidebar-link">代码风格</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/4.团队协作.html#团队协作" class="sidebar-link">团队协作</a></li></ul></li><li><a href="/index/6.前端工程/5.社区发展.html" class="sidebar-link">5.社区发展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/index/6.前端工程/5.社区发展.html#ssr" class="sidebar-link">SSR</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/5.社区发展.html#大前端" class="sidebar-link">大前端</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/5.社区发展.html#微服务" class="sidebar-link">微服务</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/5.社区发展.html#bff" class="sidebar-link">BFF</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/5.社区发展.html#serverless" class="sidebar-link">Serverless</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/5.社区发展.html#webassembly" class="sidebar-link">WebAssembly</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/5.社区发展.html#less-code-no-code" class="sidebar-link">Less code/No code</a></li></ul></li><li><a href="/index/6.前端工程/6.安全.html" class="sidebar-link">6.安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/index/6.前端工程/6.安全.html#xss" class="sidebar-link">XSS</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/6.安全.html#csrf" class="sidebar-link">CSRF</a></li><li class="sidebar-sub-header"><a href="/index/6.前端工程/6.安全.html#same-origin-policy" class="sidebar-link">Same-Origin Policy</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>7.前后端交互</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>8.计算机基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>9.面试相关</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2-webpack4"><a href="#_2-webpack4" class="header-anchor">#</a> 2.webpack4</h1> <h2 id="关键点"><a href="#关键点" class="header-anchor">#</a> 关键点</h2> <ol><li>webpack：是js静态打包器；</li> <li>loader：webpack本身只能打包js，处理其他类型的文件，需要使用到loader；loader还可以根据模块来设置相应的处理，例如tree shaking范围等；</li> <li>hmr：websocket推送manifest和要替换的新的chunk；</li> <li>生产环境：tree shaking（side effect）;source map; uglifiy;</li> <li>webpack-dev-server/webpack-dev-middleware；</li> <li>懒加载：</li> <li><ol><li>CommonsChunkPlugin -&gt; splitChunks;</li></ol></li> <li><ol start="2"><li>动态导入dynamic imports:</li></ol></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">const</span> <span class="token function-variable function">notFound</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;index&quot; */</span> <span class="token string">'@views/common/404'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">notFound</span> <span class="token operator">=</span> <span class="token parameter">r</span> <span class="token operator">=&gt;</span> require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">r</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@views/common/404'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'index'</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="webpack工作流程-生命周期"><a href="#webpack工作流程-生命周期" class="header-anchor">#</a> webpack工作流程（生命周期）</h2> <ol><li>初始化参数：从配置文件和 Shell 语句中读取与合并参数,得出最终的参数。</li> <li>开始编译：用上一步得到的参数初始化<strong>Compiler</strong>对象, <strong>加载所有配置的插件</strong>,执行对象的 run 方法开始执行编译。</li> <li>确定入口：根据配置中的 entry 找出所有的入口文件。</li> <li>编译模块：从入口文件出发,调用所有配置的 Loader 对模块进行翻译,再找出该模块依赖的模块,再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理。</li> <li>完成模块编译：在经过第 4 步使用 <strong>Loader</strong> 翻译完所有模块后,得到了每个模块被翻译后的最终内容以及它们之间的依赖关系。</li> <li>输出资源：根据入口和模块之间的依赖关系,组装成一个个包含多个模块的 Chunk,再把每个 Chunk 转换成一个单独的文件加入到输出列表,这步是可以修改输出内容的最后机会。</li> <li>输出完成：在确定好输出内容后,根据配置确定输出的路径和文件名,把文件内容写入到文件系统。</li></ol> <h2 id="loader、plugin原理"><a href="#loader、plugin原理" class="header-anchor">#</a> loader、plugin原理</h2> <p>loader是文件加载器，能够加载资源文件，并对这些文件进行特定的处理，然后打包的指定文件中，简单来说就是将webpack传入的字符串做出特定的处理修改。</p> <p>loader特点：</p> <ul><li>loader的执行顺序和代码书写的顺序是相反的，即：最后一个loader最先执行，第一个loader最后执行；</li> <li>第一个执行的loader会接收源文件做为参数，下一次执行的loader会接收前一个loader执行的返回值做为参数。</li></ul> <p>loader原则：</p> <ul><li>单一原则: 每个 Loader 只做一件事；</li> <li>链式调用: Webpack 会按顺序链式调用每个 Loader；</li> <li>统一原则: 遵循 Webpack 制定的设计规则和结构，输入与输出均为字符串，各个 Loader 完全独立，即插即用；</li></ul> <p>plugin，Webpack 运行的生命周期中会广播出许多事件，Plugin 可以监听这些事件，在合适的时机通过 Webpack 提供的 API 改变输出结果。plugin是一个具有 apply方法的 js对象。 apply方法会被 webpack的 compiler（编译器）对象调用，并且 compiler 对象可在整个 compilation（编译）生命周期内访问。</p> <p>主要靠两个对象：</p> <ul><li>compiler对象</li> <li>compilation对象</li></ul> <h2 id="webpack4"><a href="#webpack4" class="header-anchor">#</a> webpack4</h2> <p>网页打包工具，webpack。依赖nodejs。把零散的js文件、less文件、图片文件，打包成为一个bundle。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 初始化，并安装webpack</span>
npm init
<span class="token comment">// 生成package.json</span>
npm install webpack <span class="token operator">-</span>g
npm install webpack <span class="token operator">--</span>save<span class="token operator">-</span>dev
npm install webpack<span class="token operator">-</span>cli <span class="token operator">-</span>g
npm install webpack<span class="token operator">-</span>cli <span class="token operator">--</span>save<span class="token operator">-</span>dev

<span class="token comment">// 建一个a.js</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello webpack'</span><span class="token punctuation">)</span>
<span class="token comment">// 在终端中输入，并在页面中引用dist.js</span>
webpack a<span class="token punctuation">.</span>js dist<span class="token punctuation">.</span>js
</code></pre></div><p>webpack按照CMD规范的进行处理。除了自己写的js文件，从npm上安装的module也都会按照cmd规范进行引用。</p> <h2 id="配置webpack4"><a href="#配置webpack4" class="header-anchor">#</a> 配置webpack4</h2> <p>使用webpack.config.js配置webpack4，放在项目的根目录。</p> <ul><li>Entry：入口文件配置，Webpack 执行构建的第一步将从 Entry 开始，完成整个工程的打包。</li> <li>Module：模块，在Webpack里一切皆模块，Webpack会从配置的Entry开始递归找出所有依赖的模块，最常用的是rules配置项，功能是匹配对应的后缀，从而针对代码文件完成格式转换和压缩合并等指定的操作。</li> <li>Loader：模块转换器，用于把模块原内容按照需求转换成新内容，这个是配合Module模块中的rules中的配置项来使用。</li> <li>Plugins：扩展插件，在Webpack构建流程中的特定时机注入扩展逻辑来改变构建结果或做你想要的事情。(插件API)</li> <li>Output：输出结果，在Webpack经过一系列处理并得出最终想要的代码后输出结果，配置项用于指定输出文件夹，默认是./dist。</li> <li>DevServer：用于配置开发过程中使用的本机服务器配置，属于webpack-dev-server这个插件的配置项。</li></ul> <p>打包流程：</p> <ol><li>根据传入的参数模式(development | production)来加载对应的默认配置</li> <li>在entry里配置的module开始递归解析entry所依赖的所有module</li> <li>每一个module都会根据rules的配置项去寻找用到的loader,接受所配置的loader的处理</li> <li>以entry中的配置对象为分组，每一个配置入口和其对应的依赖文件最后组成一个代码块文件(chunk)并输出</li> <li>整个流程中webpack会在恰当的时机执行plugin的逻辑，来完成自定义的插件逻辑</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 配置React开发项目</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> CopyWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'copy-webpack-plugin'</span><span class="token punctuation">)</span> <span class="token comment">// 复制静态资源的插件</span>
<span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span> <span class="token comment">// 清空打包目录的插件</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span> <span class="token comment">// 生成html的插件</span>
<span class="token keyword">const</span> ExtractTextWebapckPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'extract-text-webpack-plugin'</span><span class="token punctuation">)</span> <span class="token comment">//CSS文件单独提取出来</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token punctuation">{</span>
        index<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token string">'index.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        page<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token string">'page.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        vendor<span class="token operator">:</span><span class="token string">'lodash'</span> <span class="token comment">// 多个页面所需的公共库文件，防止重复打包带入</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span><span class="token punctuation">{</span>
        publicPath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token comment">// 这里要放的是静态资源CDN的地址</span>
        path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        filename<span class="token operator">:</span><span class="token string">'[name].[hash].js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    resolve<span class="token operator">:</span><span class="token punctuation">{</span>
        extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.js&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;.css&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;.json&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        alias<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//配置别名可以加快webpack查找模块的速度</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    module<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 多个loader是有顺序要求的，从右往左写，因为转换的时候是从右往左转换的</span>
        rules<span class="token operator">:</span><span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    test<span class="token operator">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
                    use<span class="token operator">:</span> ExtractTextWebapckPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        fallback<span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
                        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">]</span> <span class="token comment">// 不再需要style-loader放到html文件内</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//限制范围，提高打包速度</span>
                    exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    test<span class="token operator">:</span><span class="token regex">/\.less$/</span><span class="token punctuation">,</span>
                    use<span class="token operator">:</span> ExtractTextWebapckPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        fallback<span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
                        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span> <span class="token string">'less-loader'</span><span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    test<span class="token operator">:</span><span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>
                    use<span class="token operator">:</span> ExtractTextWebapckPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                        fallback<span class="token operator">:</span> <span class="token string">'style-loader'</span><span class="token punctuation">,</span>
                        use<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'postcss-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span><span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    exclude<span class="token operator">:</span> <span class="token regex">/node_modules/</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    test<span class="token operator">:</span> <span class="token regex">/\.jsx?$/</span><span class="token punctuation">,</span>
                    use<span class="token operator">:</span> <span class="token punctuation">{</span>
                        loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                        query<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">//同时可以把babel配置写到根目录下的.babelrc中</span>
                            presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'env'</span><span class="token punctuation">,</span> <span class="token string">'stage-0'</span><span class="token punctuation">]</span> <span class="token comment">// env转换es6 stage-0转es7</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>     <span class="token comment">// file-loader 解决css等文件中引入图片路径的问题</span>
                      <span class="token comment">// url-loader 当图片较小的时候会把图片BASE64编码，大于limit参数的时候还是使用file-loader 进行拷贝</span>
                    test<span class="token operator">:</span> <span class="token regex">/\.(png|jpg|jpeg|gif|svg)/</span><span class="token punctuation">,</span>
                    use<span class="token operator">:</span> <span class="token punctuation">{</span>
                        loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
                        options<span class="token operator">:</span> <span class="token punctuation">{</span>
                            outputPath<span class="token operator">:</span> <span class="token string">'images/'</span><span class="token punctuation">,</span> <span class="token comment">// 图片输出的路径</span>
                            limit<span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">1024</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token comment">// 多入口的html文件用chunks这个参数来区分</span>
            <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">,</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                filename<span class="token operator">:</span><span class="token string">'index.html'</span><span class="token punctuation">,</span>
                chunks<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token string">'vendor'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                hash<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//防止缓存</span>
                minify<span class="token operator">:</span><span class="token punctuation">{</span>
                    removeAttributeQuotes<span class="token operator">:</span><span class="token boolean">true</span><span class="token comment">//压缩 去掉引号</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                template<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">,</span><span class="token string">'page.html'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                filename<span class="token operator">:</span><span class="token string">'page.html'</span><span class="token punctuation">,</span>
                chunks<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'page'</span><span class="token punctuation">,</span> <span class="token string">'vendor'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                hash<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//防止缓存</span>
                minify<span class="token operator">:</span><span class="token punctuation">{</span>
                    removeAttributeQuotes<span class="token operator">:</span><span class="token boolean">true</span><span class="token comment">//压缩 去掉引号</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                _<span class="token operator">:</span><span class="token string">'lodash'</span> <span class="token comment">//所有页面都会引入 _ 这个变量，不用再import引入</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token comment">// 其实这个特性只用于打包生产环境，测试环境这样设置会影响HMR</span>
            <span class="token keyword">new</span> <span class="token class-name">ExtractTextWebapckPlugin</span><span class="token punctuation">(</span><span class="token string">'css/[name].[hash].css'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
            <span class="token keyword">new</span> <span class="token class-name">CopyWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token keyword">from</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    to<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist/static'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    ignore<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.*'</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        devtool<span class="token operator">:</span> <span class="token string">'eval-source-map'</span><span class="token punctuation">,</span> <span class="token comment">// 指定加source-map的方式</span>
        devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
            contentBase<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//静态文件根目录</span>
            port<span class="token operator">:</span> <span class="token number">3824</span><span class="token punctuation">,</span> <span class="token comment">// 端口</span>
            host<span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
            overlay<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            compress<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// 服务器返回浏览器的时候是否启动gzip压缩</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        watch<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启监听文件更改，自动刷新</span>
        watchOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
            ignored<span class="token operator">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span> <span class="token comment">//忽略不用监听变更的目录</span>
            aggregateTimeout<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token comment">//防止重复保存频繁重新编译,500毫秒内重复保存不打包</span>
        poll<span class="token operator">:</span><span class="token number">1000</span> <span class="token comment">//每秒询问的文件变更的次数</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="babel"><a href="#babel" class="header-anchor">#</a> Babel</h2> <p>原理：</p> <ol><li>ES6代码输入</li> <li>babylon进行解析，得到AST</li> <li>plugin用babel-traverse对AST树进行遍历转译，得到新的AST树</li> <li>用babel-generator通过AST树生成ES5代码</li></ol> <p>想具有解析ES2016和jsx文件是babel的能力，一定要记住先安装：</p> <div class="language-js extra-class"><pre class="language-js"><code>cnpm install babel<span class="token operator">-</span>loader babel<span class="token operator">-</span>core
</code></pre></div><p>然后创建一个.babelrc文件，配置babel。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">'presets'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'es2015'</span><span class="token punctuation">,</span>
        <span class="token string">'es2016'</span><span class="token punctuation">,</span>
        <span class="token string">'es2017'</span><span class="token punctuation">,</span>
        <span class="token string">'stage-0'</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'plugins'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'transform-object-rest-spread'</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="webpack-dev-server"><a href="#webpack-dev-server" class="header-anchor">#</a> webpack-dev-server</h2> <p>The webpack-dev-server is a little Node.js Express server。可以模拟一个服务器，底层是nodejs+express，让前端代码可以不在阿帕奇中但是快速能够获得一个服务器环境。并且是自动检测代码改变的，可以替代之前的watch功能。</p> <div class="language-js extra-class"><pre class="language-js"><code>npm install webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server <span class="token operator">--</span>save<span class="token operator">-</span>dev
<span class="token comment">// 在package.json中script添加执行语句，'start': 'webpack-dev-server'</span>
</code></pre></div><p>可以在webpack.config.js配置output/publicPath设置：</p> <div class="language-js extra-class"><pre class="language-js"><code>output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    publicPath<span class="token operator">:</span> <span class="token string">'/mydist'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输入127.0.0.1：8888/mydist/bundle.js可以看到打包后的文件</span>
</code></pre></div><h2 id="热更新机制"><a href="#热更新机制" class="header-anchor">#</a> 热更新机制</h2> <p>模块热替换(HMR - Hot Module Replacement)功能会在应用程序运行过程中替换、添加或删除模块，而无需重新加载整个页面。</p> <h2 id="懒加载机制"><a href="#懒加载机制" class="header-anchor">#</a> 懒加载机制</h2> <p>懒加载或者按需加载，是先把你的代码在一些逻辑断点处分离开，然后在一些代码块中完成某些操作后，立即引用或即将引用另外一些新的代码块。这样加快了应用的初始加载速度，减轻了它的总体体积，因为某些代码块可能永远不会被加载。</p> <h2 id="postcss"><a href="#postcss" class="header-anchor">#</a> postcss</h2> <p>postcss是一个工具，本身不会对css一顿操作，它通过插件实现功能，autoprefixer 就是其一。
postcss一种对css编译的工具，类似babel对js的处理，常见的功能如：</p> <ol><li>使用下一代css语法：postcss-cssnext;</li> <li>自动补全浏览器前缀：Autoprefixer;</li> <li>自动把px代为转换成rem/vw：postcss-pxtorem/pxtovw;</li> <li>css代码压缩等等;</li></ol> <p>less/sass是预处理器，用来支持扩充css语法。
postcss既不是预处理器也不是后处理器，其功能比较广泛，而且重要的一点是，postcss可以和less/sass结合使用。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新于:</span> <span class="time">10/16/2020, 12:35:56 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/index/6.前端工程/1.前端工程化.html" class="prev">
        1.前端工程化
      </a></span> <span class="next"><a href="/index/6.前端工程/3.混合APP.html">
        3.混合APP
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/index/assets/js/app.616a5d86.js" defer></script><script src="/index/assets/js/3.1c123f76.js" defer></script><script src="/index/assets/js/48.4ffdce64.js" defer></script>
  </body>
</html>
